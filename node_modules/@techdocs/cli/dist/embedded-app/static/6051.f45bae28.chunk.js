"use strict";(()=>{(self.webpackChunktechdocs_cli_embedded_app=self.webpackChunktechdocs_cli_embedded_app||[]).push([[6051],{76051:function(ue,Z,d){d.r(Z),d.d(Z,{RealLogViewer:function(){return ae}});var h=d(52322),g=d(2784),V=d(10289),y=d(61837),U=d(19353),W=d(7688),D=d(50166),G=d(46212);const L=(0,G.Z)(),b=/\n\r?/g,j=Object.fromEntries(Object.entries({1:e=>({...e,bold:!0}),3:e=>({...e,italic:!0}),4:e=>({...e,underline:!0}),22:({bold:e,...n})=>n,23:({italic:e,...n})=>n,24:({underline:e,...n})=>n,30:e=>({...e,foreground:"black"}),31:e=>({...e,foreground:"red"}),32:e=>({...e,foreground:"green"}),33:e=>({...e,foreground:"yellow"}),34:e=>({...e,foreground:"blue"}),35:e=>({...e,foreground:"magenta"}),36:e=>({...e,foreground:"cyan"}),37:e=>({...e,foreground:"white"}),39:({foreground:e,...n})=>n,90:e=>({...e,foreground:"grey"}),40:e=>({...e,background:"black"}),41:e=>({...e,background:"red"}),42:e=>({...e,background:"green"}),43:e=>({...e,background:"yellow"}),44:e=>({...e,background:"blue"}),45:e=>({...e,background:"magenta"}),46:e=>({...e,background:"cyan"}),47:e=>({...e,background:"white"}),49:({background:e,...n})=>n}).map(([e,n])=>[`\x1B[${e}m`,n]));class C{lastChunk(){return this.chunks[this.chunks.length-1]}replaceLastChunk(n){n&&(this.chunks.splice(this.chunks.length-1,1,...n),this.text=this.chunks.map(t=>t.text).join("").toLocaleLowerCase("en-US"))}constructor(n=1,t=[]){this.lineNumber=n,this.chunks=t,this.text=t.map(s=>s.text).join("").toLocaleLowerCase("en-US")}}class P{process(n){if(this.text===n)return this.lines;if(n.startsWith(this.text)){var t;const r=this.lines.length>0?this.lines.length-1:0;var s;const i=(s=this.lines[r])!==null&&s!==void 0?s:new C,c=i.lastChunk();var o;const l=this.processLines(((o=c==null?void 0:c.text)!==null&&o!==void 0?o:"")+n.slice(this.text.length),c==null?void 0:c.modifiers,i==null?void 0:i.lineNumber);i.replaceLastChunk((t=l[0])===null||t===void 0?void 0:t.chunks),this.lines[r]=i,this.lines.push(...l.slice(1))}else this.lines=this.processLines(n);return this.text=n,this.lines}constructor(){this.text="",this.lines=[],this.processLines=(n,t={},s=1)=>{const o=[];let r=t,i=s,c=0;for(b.lastIndex=0;;){const u=b.exec(n);if(!u){const m=this.processText(n.slice(c),r);return o.push(new C(i,m)),o}const a=n.slice(c,u.index);c=u.index+u[0].length;const f=this.processText(a,r);o.push(new C(i,f));var l;r=(l=f[f.length-1].modifiers)!==null&&l!==void 0?l:r,i+=1}},this.processText=(n,t)=>{const s=[];let o=t,r=0;for(L.lastIndex=0;;){const i=L.exec(n);if(!i)return s.push({text:n.slice(r),modifiers:o}),s;const c=n.slice(r,i.index);s.push({text:c,modifiers:o}),r=i.index+i[0].length,o=this.processCode(i[0],o)}},this.processCode=(n,t)=>{var s,o;return(o=(s=j[n])===null||s===void 0?void 0:s.call(j,t))!==null&&o!==void 0?o:t}}}var $=d(79692),I=d(41128),k=d(31754),B=d(66054),R=d(81463),F=d(34505),M=d(57186),N=d(32720),T=d(92901),A=d(45410);const E=40,w=(0,$.Z)(e=>({root:{background:e.palette.background.paper},header:{height:E,display:"flex",alignItems:"center",justifyContent:"flex-end"},log:{fontFamily:'"Monaco", monospace',fontSize:e.typography.pxToRem(12)},line:{position:"relative",whiteSpace:"pre","&:hover":{background:e.palette.action.hover}},lineSelected:{background:e.palette.action.selected,"&:hover":{background:e.palette.action.selected}},lineCopyButton:{position:"absolute",paddingTop:0,paddingBottom:0},lineNumber:{display:"inline-block",textAlign:"end",width:60,marginRight:e.spacing(1),cursor:"pointer"},textHighlight:{background:(0,I.Fq)(e.palette.info.main,.15)},textSelectedHighlight:{background:(0,I.Fq)(e.palette.info.main,.4)},modifierBold:{fontWeight:e.typography.fontWeightBold},modifierItalic:{fontStyle:"italic"},modifierUnderline:{textDecoration:"underline"},modifierForegroundBlack:{color:k.Z.black},modifierForegroundRed:{color:B.Z[500]},modifierForegroundGreen:{color:R.Z[500]},modifierForegroundYellow:{color:F.Z[500]},modifierForegroundBlue:{color:M.Z[500]},modifierForegroundMagenta:{color:N.Z[500]},modifierForegroundCyan:{color:T.Z[500]},modifierForegroundWhite:{color:k.Z.white},modifierForegroundGrey:{color:A.Z[500]},modifierBackgroundBlack:{background:k.Z.black},modifierBackgroundRed:{background:B.Z[500]},modifierBackgroundGreen:{background:R.Z[500]},modifierBackgroundYellow:{background:F.Z[500]},modifierBackgroundBlue:{background:M.Z[500]},modifierBackgroundMagenta:{background:N.Z[500]},modifierBackgroundCyan:{background:T.Z[500]},modifierBackgroundWhite:{background:k.Z.white},modifierBackgroundGrey:{background:A.Z[500]}}),{name:"BackstageLogViewer"});var Y=d(72779),z=d.n(Y),J=d(74600),K=d.n(J);function Q(e,n){const t=new Array;if(n.bold&&t.push(e.modifierBold),n.italic&&t.push(e.modifierItalic),n.underline&&t.push(e.modifierUnderline),n.foreground){const s=`modifierForeground${K()(n.foreground)}`;t.push(e[s])}if(n.background){const s=`modifierBackground${K()(n.background)}`;t.push(e[s])}return t.length>0?t.join(" "):void 0}function X(e,n){if(!n||!e.includes(n))return;const t=new Array;let s=0;for(;;){const o=e.indexOf(n,s);if(o===-1)break;const r=o+n.length;t.push({start:o,end:r}),s=r}return t}function q(e,n){const t=X(e.text,n);if(!t)return e.chunks;const s=new Array;let o=0,r=0,i=t[r];for(const c of e.chunks){const{text:l,modifiers:u}=c;if(!i||o+l.length<i.start){s.push(c),o+=l.length;continue}let a=0;for(;i;){const m=Math.max(i.start-o,0);if(m>l.length)break;const v=Math.min(i.end-o,l.length);if(m>a&&s.push({text:l.slice(a,m),modifiers:u}),v>m&&s.push({modifiers:u,highlight:r,text:l.slice(m,v)}),a=v,i.end-o===v)r+=1,i=t[r];else break}a<l.length&&s.push({text:l.slice(a),modifiers:u}),o+=l.length}return s}function _({line:e,classes:n,searchText:t,highlightResultIndex:s}){const o=(0,g.useMemo)(()=>q(e,t),[e,t]),r=(0,g.useMemo)(()=>o.map(({text:i,modifiers:c,highlight:l},u)=>(0,h.jsx)("span",{className:z()(Q(n,c),l!==void 0&&(l===s?n.textSelectedHighlight:n.textHighlight)),children:i},u)),[o,s,n]);return(0,h.jsx)(h.Fragment,{children:r})}var ee=d(86619),ne=d(90436),te=d(48049),oe=d(51209),H=d(36444);function se(e){const{resultCount:n,resultIndexStep:t,toggleShouldFilter:s}=e;var o;const r=(o=e.resultIndex)!==null&&o!==void 0?o:0,i=c=>{c.key==="Enter"&&(c.metaKey||c.ctrlKey||c.altKey?s():t(c.shiftKey))};return(0,h.jsxs)(h.Fragment,{children:[n!==void 0&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(y.Z,{size:"small",onClick:()=>t(!0),children:(0,h.jsx)(te.Z,{})}),(0,h.jsxs)(ne.Z,{children:[Math.min(r+1,n),"/",n]}),(0,h.jsx)(y.Z,{size:"small",onClick:()=>t(),children:(0,h.jsx)(oe.Z,{})})]}),(0,h.jsx)(ee.Z,{size:"small",variant:"standard",placeholder:"Search",value:e.searchInput,onKeyPress:i,onChange:c=>e.setSearchInput(c.target.value)}),(0,h.jsx)(y.Z,{size:"small",onClick:s,children:e.shouldFilter?(0,h.jsx)(H.Z,{color:"primary"}):(0,h.jsx)(H.Z,{color:"disabled"})})]})}var re=d(96686);function ie(e,n){if(!n)return{lines:e};const t=[],s=[];for(const o of e)if(o.text.includes(n)){t.push(o);let r=0,i=0;for(;;){const c=o.text.indexOf(n,r);if(c===-1)break;s.push({lineNumber:o.lineNumber,lineIndex:i++}),r=c+n.length}}return{lines:t,results:s}}function le(e){var n;const[t,s]=(0,g.useState)(""),o=t.toLocaleLowerCase("en-US"),[r,i]=(0,g.useState)(0),[c,l]=(0,re.O)(!1),u=(0,g.useMemo)(()=>ie(e,o),[e,o]),a=u.results?u.results[Math.min(r,u.results.length-1)]:void 0,f=(n=u.results)===null||n===void 0?void 0:n.length,m=v=>{if(v){if(f!==void 0){const x=Math.min(r-1,f-2);i(x<0?f-1:x)}}else if(f!==void 0){const x=r+1;i(x>=f?0:x)}};return{lines:c?u.lines:e,searchText:o,searchInput:t,setSearchInput:s,shouldFilter:c,toggleShouldFilter:l,resultCount:f,resultIndex:r,resultIndexStep:m,resultLine:a==null?void 0:a.lineNumber,resultLineIndex:a==null?void 0:a.lineIndex}}var O=d(25248),ce=d(95074);function de(e){const n=(0,O.h_)(O.VE),[t,s]=(0,g.useState)(),o=t?Math.min(t.start,t.end):void 0,r=t?Math.max(t.start,t.end):void 0,[{error:i},c]=(0,ce.Z)();return(0,g.useEffect)(()=>{i&&n.post(i)},[i,n]),{shouldShowButton(l){return o===l||r===l},isSelected(l){return t?o<=l&&l<=r:!1},setSelection(l,u){s(u?a=>a?{start:a.start,end:l}:{start:l,end:l}:a=>(a==null?void 0:a.start)===l&&(a==null?void 0:a.end)===l?void 0:{start:l,end:l})},copySelection(){if(t){const l=e.slice(Math.min(t.start,t.end)-1,Math.max(t.start,t.end)).map(u=>u.chunks.map(a=>a.text).join("")).join(`
`);c(l),s(void 0)}}}}function ae(e){const n=w({classes:e.classes}),t=(0,g.useRef)(null),o=(0,g.useMemo)(()=>new P,[]).process(e.text),r=le(o),i=de(o),c=(0,V.TH)();(0,g.useEffect)(()=>{r.resultLine!==void 0&&t.current&&t.current.scrollToItem(r.resultLine-1,"center")},[r.resultLine]),(0,g.useEffect)(()=>{if(c.hash){const u=parseInt(c.hash.replace(/\D/g,""),10);i.setSelection(u,!1)}},[]);const l=(u,a)=>{i.setSelection(u,a.shiftKey)};return(0,h.jsx)(W.Z,{children:({height:u,width:a})=>(0,h.jsxs)("div",{style:{width:a,height:u},className:n.root,children:[(0,h.jsx)("div",{className:n.header,children:(0,h.jsx)(se,{...r})}),(0,h.jsx)(D.t7,{ref:t,className:n.log,height:u-E,width:a,itemData:r.lines,itemSize:20,itemCount:r.lines.length,children:({index:f,style:m,data:v})=>{const x=v[f],{lineNumber:p}=x;return(0,h.jsxs)("div",{style:{...m},className:z()(n.line,{[n.lineSelected]:i.isSelected(p)}),children:[i.shouldShowButton(p)&&(0,h.jsx)(y.Z,{"data-testid":"copy-button",size:"small",className:n.lineCopyButton,onClick:()=>i.copySelection(),children:(0,h.jsx)(U.Z,{fontSize:"inherit"})}),(0,h.jsx)("a",{role:"row",target:"_self",href:`#line-${p}`,className:n.lineNumber,onClick:S=>l(p,S),onKeyPress:S=>l(p,S),children:p}),(0,h.jsx)(_,{line:x,classes:n,searchText:r.searchText,highlightResultIndex:r.resultLine===p?r.resultLineIndex:void 0})]})}})]})})}}}]);})();

//# sourceMappingURL=6051.f45bae28.chunk.js.map